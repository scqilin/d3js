<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>d3.js path</title>
    <script src="../js/d3.min.js"></script>
    <!-- <script src="https://d3js.org/d3.v6.min.js"></script> -->
    <style>
        body {
            margin: 8px 8px 8px 32px;
            padding: 0;
        }
    </style>
</head>

<body>
    <h3>
        <a href="https://github.com/scqilin/d3js" target="_blank">Github æºç </a>
    </h3>
    <script>
        /**
         * author: scqilin
         * date: 2023-08-12
         * QQç¾¤: 959261248
         * ç›¸ä¿¡è‡ªå·±ï¼Œä½ å·²ç»èµ°äº†ä¸€åŠçš„è·¯ã€‚
         */
        console.log('ç›¸ä¿¡è‡ªå·±ï¼Œä½ å·²ç»èµ°äº†ä¸€åŠçš„è·¯ã€‚');
        // æ•°æ®æ¥æºç½‘ç»œ æˆ‘æ²¡æœ‰éªŒè¯è¿‡ https://blog.sina.com.cn/s/blog_5bc171940100jqhh.html
        // éªŒè¯è¿‡ ä¸å‡† åˆ«ç”¨äº†
        //111111 111110 111101 111100 111011 111010 111001 111000 110111 110110 110101 110100 110011 110010 110001 110000 101111 101110 101101 101100 101011 101010 101001 101000 100111 100110 100101 100100 100011 100010 100001 100000 011111 011110 011101 011100 011011 011010 011001 011000 010111 010110 010101 010100 010011 010010 010001 010000 001111 001110 001101 001100 001011 001010 001001 001000 000111 000110 000101 000100 000011 000010 000001 000000
        //63ä¹¾ 62å¢ 61 åŒäºº 60é 59å±¥ 58 è®¼ 57æ— å¦„ 56å¦ 55 å°ç•œ 54å·½ 53 å®¶äºº 52æ¸ 51 ä¸­å­š 50æ¶£ 49ç›Š 48è§‚ 47å¤§æœ‰ 46é¼ 45ç¦» 44 æ—… 43ç½ 42 æœ«æµ 41 å™¬å—‘ 40 æ™‹ 39å¤§ç•œ 38è›Š 37è´³ 36è‰® 35æŸ 34 è’™ 33é¢ 32å‰¥ 31å¤« 30å¤§è¿‡ 29é© 28å’¸ 27å…‘ 26å›° 25 éš 24èƒ 23 éœ€ 22 # 21 æ—¢æµ 20è¹‡ 19 èŠ‚ 18å 17 å±¯ 16æ¯” 15 å¤§å£® 14æ’ 13 ä¸° 12å°è¿‡ 11å½’å¦¹ 10 è§£ 9éœ‡ 8è±« 7æ³° 6å‡ 5æ˜å¤· 4è°¦ 3ä¸´ 2å¸ˆ 1å¤ 0å¤
        const guaObj = {
            '111111': { name: 'ä¹¾', value: 63 },
            '111110': { name: 'å¢', value: 62 },
            '111101': { name: 'åŒäºº', value: 61 },
            '111100': { name: 'é', value: 60 },
            '111011': { name: 'å±¥', value: 59 },
            '111010': { name: 'è®¼', value: 58 },
            '111001': { name: 'æ— å¦„', value: 57 },
            '111000': { name: 'å¦', value: 56 },
            '110111': { name: 'å°ç•œ', value: 55 },
            '110110': { name: 'å·½', value: 54 },
            '110101': { name: 'å®¶äºº', value: 53 },
            '110100': { name: 'æ¸', value: 52 },
            '110011': { name: 'ä¸­å­š', value: 51 },
            '110010': { name: 'æ¶£', value: 50 },
            '110001': { name: 'ç›Š', value: 49 },
            '110000': { name: 'è§‚', value: 48 },
            '101111': { name: 'å¤§æœ‰', value: 47 },
            '101110': { name: 'é¼', value: 46 },
            '101101': { name: 'ç¦»', value: 45 },
            '101100': { name: 'æ—…', value: 44 },
            '101011': { name: 'ç½', value: 43 },
            '101010': { name: 'æœªæµ', value: 42 },
            '101001': { name: 'å™¬å—‘', value: 41 },
            '101000': { name: 'æ™‹', value: 40 },
            '100111': { name: 'å¤§ç•œ', value: 39 },
            '100110': { name: 'è›Š', value: 38 },
            '100101': { name: 'è´³', value: 37 },
            '100100': { name: 'è‰®', value: 36 },
            '100011': { name: 'æŸ', value: 35 },
            '100010': { name: 'è’™', value: 34 },
            '100001': { name: 'é¢', value: 33 },
            '100000': { name: 'å‰¥', value: 32 },
            '011111': { name: 'å¤«', value: 31 },
            '011110': { name: 'å¤§è¿‡', value: 30 },
            '011101': { name: 'é©', value: 29 },
            '011100': { name: 'å’¸', value: 28 },
            '011011': { name: 'å…‘', value: 27 },
            '011010': { name: 'å›°', value: 26 },
            '011001': { name: 'éš', value: 25 },
            '011000': { name: 'èƒ', value: 24 },
            '010111': { name: 'éœ€', value: 23 },
            '010110': { name: 'äº•', value: 22 },
            '010101': { name: 'æ—¢æµ', value: 21 },
            '010100': { name: 'è¹‡', value: 20 },
            '010011': { name: 'èŠ‚', value: 19 },
            '010010': { name: 'å', value: 18 },
            '010001': { name: 'å±¯', value: 17 },
            '010000': { name: 'æ¯”', value: 16 },
            '001111': { name: 'å¤§å£®', value: 15 },
            '001110': { name: 'æ’', value: 14 },
            '001101': { name: 'ä¸°', value: 13 },
            '001100': { name: 'å°è¿‡', value: 12 },
            '001011': { name: 'å½’å¦¹', value: 11 },
            '001010': { name: 'è§£', value: 10 },
            '001001': { name: 'éœ‡', value: 9 },
            '001000': { name: 'è±«', value: 8 },
            '000111': { name: 'æ³°', value: 7 },
            '000110': { name: 'å‡', value: 6 },
            '000101': { name: 'æ˜å¤·', value: 5 },
            '000100': { name: 'è°¦', value: 4 },
            '000011': { name: 'ä¸´', value: 3 },
            '000010': { name: 'å¸ˆ', value: 2 },
            '000001': { name: 'å¤', value: 1 },
            '000000': { name: 'å¤', value: 0 },
        }
        let _w = 130;
        let _n = 8;
        const padding = 30;
        const svgWidth = _w * _n;
        const svgHeight = _w + 120;


        const svg = d3.select("body")
            .append("svg")
            .attr("width", svgWidth)
            .attr("height", svgHeight)
            .style('border', '1px solid #999999')
        // path

        // å…ˆç»˜åˆ¶10ä¸ªæ­£æ–¹å½¢æ ¼å­

        const gArr = [];
        for (let i = 0; i < 10; i++) {
            const g = svg.append('g')
                .attr('transform', `translate(${i * _w},0)`)
            gArr.push(g);
            // ç»˜åˆ¶æ ¼å­
            g.append('rect')
                .attr('width', _w)
                .attr('height', _w + 30)
                .attr('fill', 'none')
                .attr('stroke', '#999999')
                .attr('stroke-width', 1)
        }


        function setRound(n) {
            let g = gArr[n];
            let paths = [];
            let str = ''
            for (let i = 1; i <= 6; i++) {
                let _s = Math.random() > 0.5 ? 1 : 0;
                let path = getPath(i, _s);
                str += _s;
                paths.push(path);
            }
            let name = guaObj[str].name;
            // hehe æ•°æ®ä¸å‡† ä¸æäº†
            addPath(g, paths, n, 'â€»å¦');
        }

        for (i = 0; i < _n; i++) {
            setRound(i);
        }

        function addPath(g, paths, n, name) {
            paths.forEach((element, _i) => {
                //çº¢è‰²å’Œè“è‰²ï¼šçº¢è‰²ä»£è¡¨é˜³ï¼Œè“è‰²ä»£è¡¨é˜´ã€‚
                const path = d3.path();
                path.moveTo(element[0].x1, element[0].y1);
                path.lineTo(element[0].x2, element[0].y2);

                if (element.length > 1) {
                    path.moveTo(element[1].x1, element[1].y1);
                    path.lineTo(element[1].x2, element[1].y2);
                }

                g.append('path')
                    .attr('d', path)
                    .attr('stroke-width', 0)
                    .attr('opacity', 0)
                    .transition()
                    .delay(1000 * n + 100 * _i)
                    .duration(500)
                    .attr('opacity', 1)
                    .attr('stroke-width', 10)
                    .attr('stroke', element.length > 1 ? '#87CEEB' : '#FF7F50');

            });
            g.append('text')
                .attr('x', _w / 2)
                .attr('y', _w + 20)
                .attr('fill', '#000000')
                .attr('font-size', 20)
                .attr('text-anchor', 'middle')
                .attr('opacity', 0)
                .transition()
                .delay(1000 * n + 100 * 6)
                .duration(500)
                .attr('opacity', 1)
                .text(name);

        }


        // å†™ä¸€ä¸ªå‡½æ•° ä¼ å…¥m 1-6 ,n 0 å’Œ 1
        function getPath(m, n) {
            if (n === 1) {
                let y = m * 20 - 5;
                let x1 = 15;
                let x2 = 115;
                // è¿”å›2ä¸ªç‚¹çš„åæ ‡
                return [{ x1: x1, y1: y, x2: x2, y2: y }]
            } else {
                let y = m * 20 - 5;
                let x1 = 15;
                let x2 = 60;
                let x3 = 70;
                let x4 = 115;
                // è¿”å›4ä¸ªç‚¹çš„åæ ‡
                return [{ x1: x1, y1: y, x2: x2, y2: y }, { x1: x3, y1: y, x2: x4, y2: y }]
            }


        }


        let strs = [
            'ä½ å°†è¿æ¥å¹¸ç¦çš„æ—¶åˆ»ï¼Œä¸€åˆ‡éƒ½å°†é¡ºåˆ©è¿›è¡Œï¼Œè´¢å¯Œå’Œå¿«ä¹å°†ä¼´éšç€ä½ çš„äººç”Ÿæ—…ç¨‹ã€‚',
            'åšæŒä¸æ‡ˆçš„åŠªåŠ›å°†å¸¦æ¥å·¨å¤§çš„å›æŠ¥ï¼Œä½ çš„äº‹ä¸šå°†è’¸è’¸æ—¥ä¸Šï¼ŒæˆåŠŸå°†ä¸ä½ ç´§å¯†ç›¸è¿ã€‚',
            'ä½ çš„æ¢¦æƒ³å°†æˆä¸ºç°å®ï¼Œæœºä¼šå°†ä¸æ–­é™ä¸´åœ¨ä½ èº«ä¸Šï¼Œä½ å°†äº«å—åˆ°äº‹ä¸šå’Œç”Ÿæ´»çš„ä¸°ç››æœå®ã€‚',
            'ä½ å…·å¤‡æ— é™çš„æ½œåŠ›å’Œå‹‡æ°”ï¼Œä½ å°†è¶…è¶Šä¸€åˆ‡å›°éš¾ï¼Œè¿ˆå‘è¾‰ç…Œçš„æœªæ¥ã€‚',
            'æ¯ä¸€å¤©éƒ½æ˜¯æ–°çš„å¼€å§‹ï¼Œä½ å°†ç”¨ç§¯æçš„æ€åº¦å’Œåšå®šçš„ä¿¡å¿µåˆ›é€ å±äºè‡ªå·±çš„å¥‡è¿¹ã€‚',
            'ä½ å°†è¿æ¥äº‹ä¸šçš„é»„é‡‘æ—¶æœŸï¼Œä½ çš„åŠªåŠ›å°†å¾—åˆ°å›æŠ¥ï¼Œä½ çš„è´¢å¯Œå°†ä¸æ–­å¢åŠ ã€‚',
        ]
        // æ¨¡æ‹Ÿæ‰“å­—æœºæ•ˆæœ æŠŠæ–‡å­—ä¸€ä¸ªä¸€ä¸ªæ‰“å‡ºæ¥
        let str = strs[Math.floor(Math.random() * strs.length)];
        let _str = '';
        let _i = 0;
        let info = svg.append('text').attr('id', 'text').attr('x', svgWidth / 2).attr('y', _w + 60).attr('fill', '#000000').attr('font-size', 20).attr('text-anchor', 'middle').text('');
        setTimeout(() => {
            let timer = setInterval(() => {
                _str += str[_i];
                d3.select('#text').text(_str);
                _i++;
                if (_i >= str.length) {
                    clearInterval(timer);
                }
            }, 100);
        }, 1000 * _n + 100 * 6 - 500);
        setTimeout(() => {
            // ç‚¹å‡»äº‹ä»¶ ç‚¹å‡»è§£é”æ›´å¤šå†…å®¹
            let info2 = svg.append('text')
                .attr('x', svgWidth / 2).attr('y', _w + 100)
                .attr('fill', '#000000')
                .attr('font-size', 24)
                .attr('text-anchor', 'middle')
                .text('ç‚¹å‡»è§£é”æ›´å¤šå†…å®¹ğŸ”')
                .style('cursor', 'pointer')
                .on('click', () => {
                    let w = window.innerWidth;
                    let h = window.innerHeight;
                    let div = d3.select('body').append('div')
                        .style('position', 'absolute')
                        .style('top', 0)
                        .style('left', 0)
                        .style('width', w + 'px')
                        .style('height', h + 'px')
                        .style('background-color', '#000000F0')
                        .style('z-index', 999999999)
                        .style('text-align', 'center')
                        .style('padding-top', '100px')
                        .style('font-size', '28px')
                        .style('color', '#ffffff')
                        .style('font-weight', 'bold')
                        .style('cursor', 'pointer')
                        .text('å¼ å¼€åŒæ‰‹çœ‹çœ‹å§ï¼Œä½ çš„å‘½è¿å°±æŒæ¡åœ¨ä½ è‡ªå·±çš„æ‰‹ä¸Šï¼Œåˆ«ä¿¡é‚£äº›è™šæ— ç¼¥ç¼ˆçš„ä¸œè¥¿ã€‚')
                        .on('click', () => {
                            div.remove();
                        })
                })
        }, 1000 * _n + 100 * 6 + 3000);



    </script>

</body>

</html>